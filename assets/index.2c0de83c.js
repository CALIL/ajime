import{r as e,j as t,a,M as i,I as r,A as s,F as n,C as l,b as o,L as m,D as p,B as h,J as d,d as c,q as u,R as b,c as g}from"./vendor.71aaf48e.js";const N={"askul-56249":{id:"askul-56249",name:"アスクル 65面",sku:[["46670 強粘着","https://www.askul.co.jp/p/1979588/"],["56249 再剥離","https://www.askul.co.jp/p/1979677/"]],headerPosition:"right",marginTop:"10.92mm",marginLeft:"4.75mm",labelWidth:"38.1mm",labelHeight:"21.2mm",labelPadding:"4mm",gapX:"2.5mm",gapY:"0",labelCountX:5,labelCountY:13,borderRadius:"2mm",url:"https://www.askul.co.jp/p/1979588/",linkText:"商品情報"},"kihara-606906":{id:"kihara-606906",name:"キハラ 36面",sku:[["606-906 20シート","https://www.kihara-lib.co.jp/wp-content/uploads/kihara-catalogue-search/320.pdf"]],headerPosition:"left",marginTop:"15mm",marginLeft:"14mm",labelWidth:"44mm",labelHeight:"26mm",labelPadding:"4mm",gapX:"2mm",gapY:"4mm",labelCountX:4,labelCountY:9,borderRadius:"3mm"},"aone-28368":{id:"aone-28368",name:"エーワン 44面",sku:[["28388 レーザー用 20シート","https://www.a-one.co.jp/product/search/detail.php?id=28388"],["28368 レーザー用 100シート","https://www.a-one.co.jp/product/search/detail.php?id=28368"],["28648 レーザー用 500シート","https://www.a-one.co.jp/product/search/detail.php?id=28648"],["31165 レーザー用 1000シート","https://www.a-one.co.jp/product/search/detail.php?id=31165"],["28943 インクジェット用 20シート","https://www.a-one.co.jp/product/search/detail.php?id=28943"],["28944 インクジェット用 100シート","https://www.a-one.co.jp/product/search/detail.php?id=28944"],["28946 インクジェット用 500シート","https://www.a-one.co.jp/product/search/detail.php?id=28946"]],headerPosition:"right",marginTop:"8.8mm",marginLeft:"8.4mm",labelWidth:"48.3mm",labelHeight:"25.4mm",labelPadding:"4mm",gapX:"0",gapY:"0",labelCountX:4,labelCountY:11,borderRadius:"0"},"aone-72295":{id:"aone-72295",name:"エーワン 95面",sku:[["73295 100シート","https://www.a-one.co.jp/product/search/detail.php?id=73295"],["72295 10シート","https://www.a-one.co.jp/product/search/detail.php?id=72295"]],headerPosition:"right",marginTop:"16.5mm",marginLeft:"13.5mm",labelWidth:"35mm",labelHeight:"12mm",labelPadding:"1.5mm",gapX:"2mm",gapY:"2mm",labelCountX:5,labelCountY:19,borderRadius:"2mm"}};class f extends e.exports.Component{constructor(e){super(e),this.handleClick=(e,t)=>{const{index:a}=t,{activeIndex:i}=this.state,r=i===a?-1:a;this.setState({activeIndex:r})},this.state={activeIndex:0}}render(){const{activeIndex:e}=this.state;let d=0,c=!1;return Object.values(N).forEach((e=>{e.id===this.props.templateName&&(d=e.labelCountX*e.labelCountY,parseInt(e.labelHeight)>20&&(c=!0))})),t("div",{className:"settings",children:a("div",{children:[!1===this.props.supported?a(i,{negative:!0,size:"small",children:["お使いのブラウザでは正しく印刷できない可能性があります。以下のブラウザを推奨します。",a("ul",{children:[t("li",{children:a("a",{href:"https://www.microsoft.com/ja-jp/edge",target:"_blank",children:["Microsoft Edge ",t(r,{name:"external"})]})}),t("li",{children:a("a",{href:"https://www.google.co.jp/chrome/index.html",target:"_blank",children:["Google Chrome ",t(r,{name:"external"})]})}),t("li",{children:a("a",{href:"https://www.mozilla.org/ja/firefox/",target:"_blank",children:["Firefox ",t(r,{name:"external"})]})})]})]}):null,a("div",{className:"setting",children:[a(s,{fluid:!0,children:[a(s.Title,{active:0===e,index:0,onClick:this.handleClick,children:[t(r,{name:"dropdown"}),"ラベル用紙を選ぶ"]}),t(s.Content,{active:0===e,children:a(n,{children:[t(n.Group,{grouped:!0,children:Object.values(N).map((e=>t(n.Field,{children:t(l,{radio:!0,label:e.name,name:"template",value:e.id,checked:e.id===this.props.templateName,onChange:(e,{value:t})=>this.props.onSelectTemplate(t)})},e.id)))}),t(i,{size:"small",children:a("div",{children:["以下の用紙に対応しています。",t("ul",{children:Object.values(N).map((e=>{if(e.id===this.props.templateName)return Object.values(e.sku).map((e=>t("li",{children:a("a",{href:e[1],target:"_blank",children:[e[0]," ",t(r,{name:"external"})]})},e[0])))}))})]})})]})}),a(s.Title,{active:1===e,index:1,onClick:this.handleClick,children:[t(r,{name:"dropdown"}),"内容を決める"]}),t(s.Content,{active:1===e,children:a(n,{children:[t(i,{size:"small",children:t("div",{children:a("ul",{style:{paddingLeft:"10px"},children:[t("li",{children:"6桁～10桁程度が一般的です"}),t("li",{children:"最後にCを入力するとチェックデジットを付与します"}),t("li",{children:"先頭に0を入力すると「ゼロ埋め」ができます"}),t("li",{children:"エクセルなどで扱いやすくするたに「100000」などのようにゼロ埋めを不要とするのがおすすめです"})]})})}),a(n.Field,{children:[t("label",{children:"開始番号"}),t(o,{placeholder:"000000...",className:"startnum",value:this.props.startNumber,maxLength:14,required:!0,onChange:e=>{e.target.value.toUpperCase().match(/^[A-Z]*?[0-9]+C?$/)?this.props.changeStartNumber(e.target.value.toUpperCase()):e.target.value=this.props.startNumber}})]}),a(n.Field,{children:[t("label",{children:"図書館名"}),t(o,{placeholder:"カーリル図書館",value:this.props.libName,maxLength:16,onChange:e=>this.props.setLibName(e.target.value)}),0==c&&this.props.libName.length>0?t(m,{pointing:!0,children:"ラベルが小さいため印刷されません"}):null]})]})}),a(s.Title,{active:2===e,index:2,onClick:this.handleClick,children:[t(r,{name:"dropdown"}),"枚数を決める"]}),t(s.Content,{active:2===e,children:t(n,{children:a(n.Field,{children:[t("label",{children:"印刷するシートの枚数"}),t(o,{className:"countNumber",type:"number",value:this.props.countNumber,min:"1",max:"300",required:!0,onChange:e=>this.props.changeCountNumber(e.target.value)})]})})})]}),t(p,{}),a("div",{style:{marginTop:"10px",textAlign:"center"},children:[a("p",{style:{marginBottom:"10px"},children:["合計 ",parseInt(this.props.countNumber)*d," 個のバーコード"]}),a(h,{primary:!0,icon:!0,loading:this.props.printing,size:"big",labelPosition:"right",onClick:this.props.print,children:["印刷する",t(r,{name:"print"})]})]})]}),t("div",{className:"cppyLink",children:a("div",{onClick:this.props.copyUrl,children:[t("i",{className:"copy outline icon"}),t("span",{children:"設定をURLとしてコピー"})]})})]})})}}const C=i=>{const{number:r,libName:s,template:n,checkDigit:l,prefixAlphabet:o}=i,m=e.exports.useRef(null);let p=r;""!==o&&(p=o+r);const h=parseInt(n.labelHeight)>20;e.exports.useEffect((()=>{d(m.current,p,{format:""!==o?"code39":"codabar",width:2.25,height:h?40:26,displayValue:!1,margin:0})}),[n,p]);const c=""!==s&&h;return a("div",{className:"barcode",style:{display:"inline-flex",flexDirection:"column",boxSizing:"border-box",justifyContent:"center",alignItems:"center",width:n.labelWidth,height:n.labelHeight,borderRadius:n.borderRadius,padding:c?parseInt(n.labelPadding)/2+"mm":n.labelPadding,paddingTop:c?parseInt(n.labelPadding)/3+"mm":n.labelPadding,border:"1px solid #CCCCCC"},children:[c?t("div",{className:"libName",style:{fontFamily:'"Noto Sans JP"',fontSize:s.length<10?"3mm":"1.5mm",fontWeight:400,marginBottom:"1mm",lineHeight:"3.8mm"},children:s}):null,t("svg",{ref:m,xmlns:"http://www.w3.org/2000/svg",version:"1.1"}),a("div",{style:{fontFamily:'"Conv_OCRB",Sans-Serif',fontSize:h?"3.5mm":"1.5mm",marginTop:h?"1.3mm":"0.5mm",lineHeight:h?"3.5mm":"2.5mm"},children:[p,null!==l?t("span",{style:{textDecoration:"underline"},children:l}):null]})]})},w=(e,t,a)=>{let i="";if(t){const t=a.replace(/[A-Z]/g,"").length-String(e).length;Array.from({length:t}).forEach((()=>i+="0"))}return i+String(e)};class x extends e.exports.Component{constructor(e){super(e);const t=JSON.parse(localStorage.getItem("state")),a=c();let i=!1;!a||"chrome"!==a.name&&"firefox"!==a.name&&"edge"!==a.name&&"edge-chromium"!==a.name||(i=!0),this.state={templateName:t&&t.templateName?t.templateName:"aone-28368",libName:t&&t.libName?t.libName:"",perPage:0,startNumber:t&&t.startNumber?t.startNumber:"100000",prefixZero:!1,countNumber:t&&t.countNumber?t.countNumber:"1",splitNumbers:[],suffixCheckDigit:!1,prefixAlphabet:"",printing:!1,supported:i,noHeader:!1}}componentDidMount(){const e=u.parse(location.hash);let t=e.template;t&&N[t]?this.setTemplate(t):this.setTemplate(this.state.templateName);let a=e.start;a?this.setState({startNumber:a},(()=>this.setStartNumber(this.state.startNumber))):this.setStartNumber(this.state.startNumber);let i=e.sheet;i&&this.setCountNumber(i);let r=e.library;r&&this.setLibName(decodeURIComponent(r)),"true"===e.print&&this.print(),"true"===e.noheader&&this.setState({noHeader:!0}),window.addEventListener("afterprint",(e=>{this.setState({printing:!1})}))}setTemplate(e){let t=N[e].labelCountX*N[e].labelCountY;this.setState({perPage:t,templateName:e},(()=>{this.renderBarCodes(),this.saveState()}))}setStartNumber(e){if(""===e)return;const t=!!e.match(/^[A-Z]*?0+[0-9]+/);let a="";if(e.match(/^[A-Z]+[0-9]+C?$/)){let t=e.match(/^[A-Z]+/);t&&(a=t[0])}const i=!!e.match(/C$/);this.setState({startNumber:e,prefixZero:t,suffixCheckDigit:i,prefixAlphabet:a},(()=>{this.renderBarCodes(),this.saveState()}))}setCountNumber(e){const t=parseInt(e);this.setState({countNumber:String(t&&t>0?e:1)},(()=>{this.renderBarCodes(),this.saveState()}))}setLibName(e){this.setState({libName:e},this.saveState.bind(this))}saveState(){const e={templateName:this.state.templateName,libName:this.state.libName,startNumber:this.state.startNumber,countNumber:this.state.countNumber};localStorage.setItem("state",JSON.stringify(e))}renderBarCodes(){const e=parseInt(this.state.startNumber.replace(/[A-Z]/g,"")),t=parseInt(this.state.countNumber)*this.state.perPage,a=[];let i=e;Array.from({length:t}).forEach((()=>{let e=w(i,this.state.prefixZero,this.state.startNumber);a.push(e),i+=1}));const r=((e,t)=>{const a=[];for(let i=0;i<e.length;i+=t){const r=e.slice(i,i+t);a.push(r)}return a})(a,this.state.perPage);return this.setState({splitNumbers:r}),!0}print(){this.setState({printing:!0},(()=>{setTimeout((()=>{window.print()}),300)}))}copyUrl(){const e=location.protocol+"//"+location.host+location.pathname+"#"+u.stringify({template:this.state.templateName,start:this.state.startNumber,library:encodeURIComponent(this.state.libName),sheet:this.state.countNumber}),t=a=>{a.clipboardData.setData("text/plain",e),a.preventDefault(),document.removeEventListener("copy",t)};document.addEventListener("copy",t),document.execCommand("copy")}render(){return a(b.Fragment,{children:[this.state.noHeader?null:a("header",{children:[t("h1",{children:"カーリルToolBox : バーコード連番印刷"}),t("div",{style:{position:"absolute",top:"15px",right:"15px"},children:a(h,{as:"a",href:"https://github.com/CALIL/ajime",target:"_blank",color:"black",children:[t(r,{name:"github"})," GitHub"]})})]}),a("div",{className:"container",children:[t(f,{templateName:this.state.templateName,onSelectTemplate:this.setTemplate.bind(this),startNumber:this.state.startNumber,countNumber:this.state.countNumber,changeStartNumber:this.setStartNumber.bind(this),changeCountNumber:this.setCountNumber.bind(this),libName:this.state.libName,setLibName:this.setLibName.bind(this),renderBarCodes:this.renderBarCodes.bind(this),printing:this.state.printing,print:this.print.bind(this),copyUrl:this.copyUrl.bind(this),supported:this.state.supported}),a("div",{className:"sheets",children:[this.state.splitNumbers.map(((e,a)=>{const i=N[this.state.templateName];return t(v,{index:a,numbers:e,template:i,startNumber:this.state.startNumber,perPage:this.state.perPage,libName:this.state.libName,countNumber:this.state.countNumber,prefixAlphabet:this.state.prefixAlphabet,suffixCheckDigit:this.state.suffixCheckDigit,prefixZero:this.state.prefixZero,printing:this.state.printing},a)})),this.state.splitNumbers.length>5?t("p",{className:"nopreview",children:"6枚目以降はプレビューされません"}):null]})]})]})}}const v=e=>{const{index:i,numbers:r,template:s,startNumber:n,perPage:l,libName:o,prefixAlphabet:m,suffixCheckDigit:p,prefixZero:h,printing:d,countNumber:c}=e;if(!1===d&&i>=5)return null;const u=w(parseInt(n.replace(/[A-Z]/g,"")),h,n),b=w(parseInt(n.replace(/[A-Z]/g,""))+l*c-1,h,n);return a("section",{className:"sheet",style:{paddingTop:s.marginTop,paddingLeft:s.marginLeft,display:"grid",gridTemplateColumns:`repeat(${s.labelCountX}, ${s.labelWidth})`,gridTemplateRows:`repeat(${s.labelCountY}, ${s.labelHeight})`,columnGap:s.gapX,rowGap:s.gapY},children:[a("p",{style:{position:"absolute",top:parseFloat(s.marginTop)-4.5>0?parseFloat(s.marginTop)-4.5+"mm":"0",right:"right"===s.headerPosition?parseInt(s.marginLeft)+parseInt(s.gapX)+"mm":"auto",left:"left"===s.headerPosition?parseInt(s.marginLeft)+parseInt(s.gapX)+"mm":"auto",fontSize:"3mm",lineHeight:"3mm"},children:[m,u,p?"C":"","～",m,b,p?"C":""," 【",""!==m?"CODE39":"NW-7",p?" (M10W21)":"","】 ",i+1,"/",c,"シート"]}),r.map((e=>{let a=null;return p&&(a=(e=>{const t=e.split("").reverse().map(((e,t)=>{const a=parseInt(e);return t%2==0?(2*a).toString().split("").reduce(((e,t)=>e+parseInt(t)),0):a})).reduce(((e,t)=>e+t),0);return t%10==0?0:10-t%10})(e.replace(/[A-Z]/g,""))),t(C,{number:e,checkDigit:a,prefixAlphabet:m,libName:o,template:s},e)})),t("img",{src:"./assets/calil.svg",alt:"カーリル",className:"logo",style:{position:"absolute",bottom:parseFloat(s.marginTop)-7>0?parseFloat(s.marginTop)-7+"mm":"0",left:parseInt(s.marginLeft)+parseInt(s.gapX)+"mm",fontSize:"3mm"}})]})};g.render(t(b.StrictMode,{children:t(x,{})}),document.getElementById("root"));
