import{r as e,R as t,A as a,I as r,F as l,C as n,M as s,a as i,D as m,B as o,J as p,q as c,b as h}from"./vendor.bcdfcb0d.js";const u={"askul-56249":{id:"askul-56249",name:"アスクル 65面",sku:[["46670 強粘着","https://www.askul.co.jp/p/1979588/"],["56249 再剥離","https://www.askul.co.jp/p/1979677/"]],headerPosition:"right",marginTop:"10.92mm",marginLeft:"4.75mm",labelWidth:"38.1mm",labelHeight:"21.2mm",labelPadding:"4mm",gapX:"2.5mm",gapY:"0",labelCountX:5,labelCountY:13,borderRadius:"2mm",url:"https://www.askul.co.jp/p/1979588/",linkText:"商品情報"},"kihara-606906":{id:"kihara-606906",name:"キハラ 36面",sku:[["606-906 20シート","https://www.kihara-lib.co.jp/wp-content/uploads/kihara-catalogue-search/320.pdf"]],headerPosition:"left",marginTop:"15mm",marginLeft:"14mm",labelWidth:"44mm",labelHeight:"26mm",labelPadding:"4mm",gapX:"2mm",gapY:"4mm",labelCountX:4,labelCountY:9,borderRadius:"3mm"},"aone-28368":{id:"aone-28368",name:"エーワン 44面",sku:[["28388 レーザープリンタ 20シート","https://www.a-one.co.jp/product/search/detail.php?id=28388"],["28368 レーザープリンタ 100シート","https://www.a-one.co.jp/product/search/detail.php?id=28368"],["28648 レーザープリンタ 500シート","https://www.a-one.co.jp/product/search/detail.php?id=28648"],["31165 レーザープリンタ 1000シート","https://www.a-one.co.jp/product/search/detail.php?id=31165"],["28943 インクジェット用 20シート","https://www.a-one.co.jp/product/search/detail.php?id=28943"],["28944 インクジェット用 100シート","https://www.a-one.co.jp/product/search/detail.php?id=28944"],["28946 インクジェット用 500シート","https://www.a-one.co.jp/product/search/detail.php?id=28946"]],headerPosition:"right",marginTop:"8.8mm",marginLeft:"8.2mm",labelWidth:"48.3mm",labelHeight:"25.4mm",labelPadding:"4mm",gapX:"0",gapY:"0",labelCountX:4,labelCountY:11,borderRadius:"0"},"aone-72295":{id:"aone-72295",name:"エーワン 95面",sku:[["73295 100シート","https://www.a-one.co.jp/product/search/detail.php?id=73295"],["72295 10シート","https://www.a-one.co.jp/product/search/detail.php?id=72295"]],headerPosition:"right",marginTop:"16.5mm",marginLeft:"13.5mm",labelWidth:"35mm",labelHeight:"12mm",labelPadding:"1mm",gapX:"2mm",gapY:"2mm",labelCountX:5,labelCountY:19,borderRadius:"2mm"}};class d extends e.exports.Component{constructor(e){super(e),this.handleClick=(e,t)=>{const{index:a}=t,{activeIndex:r}=this.state,l=r===a?-1:a;this.setState({activeIndex:l})},this.state={activeIndex:0}}render(){const{activeIndex:e}=this.state;let p=0;return Object.values(u).forEach((e=>{e.id===this.props.templateName&&(p=e.labelCountX*e.labelCountY)})),t.createElement("div",{className:"settings"},t.createElement(a,{styled:!0},t.createElement(a.Title,{active:0===e,index:0,onClick:this.handleClick},t.createElement(r,{name:"dropdown"}),"ラベル用紙を選ぶ"),t.createElement(a.Content,{active:0===e},t.createElement(l,null,t.createElement(l.Group,{grouped:!0},Object.values(u).map((e=>t.createElement(l.Field,{key:e.id},t.createElement(n,{radio:!0,label:e.name,name:"template",value:e.id,checked:e.id===this.props.templateName,onChange:(e,{value:t})=>this.props.onSelectTemplate(t)}))))),t.createElement(s,{size:"small"},t.createElement("p",null,"以下の用紙に対応しています。",t.createElement("ul",null,Object.values(u).map((e=>{if(e.id===this.props.templateName)return Object.values(e.sku).map((e=>t.createElement("li",{key:e[0]},t.createElement("a",{href:e[1],target:"_blank"},e[0]," ",t.createElement(r,{name:"external"})))))}))))))),t.createElement(a.Title,{active:1===e,index:1,onClick:this.handleClick},t.createElement(r,{name:"dropdown"}),"印刷内容を決める"),t.createElement(a.Content,{active:1===e},t.createElement(l,null,t.createElement(s,{size:"small"},t.createElement("p",null,"印刷する連番バーコードの開始番号を決めてください。",t.createElement("ul",null,t.createElement("li",null,"新しく図書館の本にバーコードを貼る場合、学校図書館の場合には6桁程度が一般的です。"),t.createElement("li",null,"番号の最後にCを入力するとチェックデジットを付与することかできます。"),t.createElement("li",null,"先頭に0を付けることで「ゼロ埋め」に対応できます。"),t.createElement("li",null,"エクセルなどで扱いやすくするたに「100000」などのようにゼロ埋めが不要となる番号とすることをお勧めします。")))),t.createElement(l.Field,null,t.createElement("label",null,"開始番号"),t.createElement(i,{placeholder:"000000...",className:"startnum",value:this.props.startNumber,maxLength:16,required:!0,onChange:(e,t)=>{e.target.value.toUpperCase().match(/^[A-Z]*?[0-9]+C?$/)?this.props.changeStartNumber(e.target.value.toUpperCase()):e.target.value=this.props.startNumber}})),t.createElement(l.Field,null,t.createElement("label",null,"図書館名"),t.createElement(i,{placeholder:"カーリル図書館",value:this.props.libName,maxLength:16,onChange:(e,t)=>this.props.setLibName(e.target.value)})))),t.createElement(a.Title,{active:2===e,index:2,onClick:this.handleClick},t.createElement(r,{name:"dropdown"}),"枚数を決める"),t.createElement(a.Content,{active:2===e},t.createElement(l,null,t.createElement(l.Field,null,t.createElement("label",null,"印刷するシート数"),t.createElement(i,{className:"countNumber",type:"number",value:this.props.countNumber,min:"1",max:"100",required:!0,onChange:(e,t)=>this.props.changeCountNumber(e.target.value)}))))),t.createElement(m,null),t.createElement("div",{style:{marginTop:"10px",textAlign:"center"}},t.createElement("p",{style:{marginBottom:"10px"}},"合計 ",parseInt(this.props.countNumber)*p," 個のバーコード"),t.createElement(o,{primary:!0,icon:!0,size:"big",labelPosition:"right",onClick:this.props.print},"印刷する",t.createElement(r,{name:"print"}))))}}const b=a=>{const{number:r,libName:l,template:n,checkDigit:s,univStartAlphabet:i}=a,m=e.exports.useRef(null);let o=r;null!==i&&(o=i+r);const c=parseInt(n.labelHeight)>20;e.exports.useEffect((()=>{p(m.current,o,{format:null!==i?"code39":"codabar",width:2.25,height:c?52:26,displayValue:!1,text:null===s?o:o+"-"+s.toString(),textMargin:0,fontSize:c?20:15,font:'"Conv_OCRB",Sans-Serif',margin:0})}),[n,o]);const h=""!==l&&c;return t.createElement("div",{className:"barcode",style:{display:"inline-flex",flexDirection:"column",boxSizing:"border-box",justifyContent:"center",alignItems:"center",width:n.labelWidth,height:n.labelHeight,borderRadius:n.borderRadius,padding:h?parseInt(n.labelPadding)/2+"mm":n.labelPadding,paddingTop:h?parseInt(n.labelPadding)/3+"mm":n.labelPadding,border:"1px solid #CCCCCC"}},h?t.createElement("div",{className:"libName",style:{fontFamily:'"Noto Sans JP"',fontSize:l.length<10?"3mm":"1.5mm",marginBottom:"1mm"}},l):null,t.createElement("svg",{ref:m,xmlns:"http://www.w3.org/2000/svg",version:"1.1"}),t.createElement("div",{style:{fontFamily:'"Conv_OCRB",Sans-Serif',fontSize:c?"3.5mm":"1.5mm",marginTop:"1mm"}},o,null!==s?t.createElement("span",{style:{fontFamily:'"Conv_OCRB",Sans-Serif',textDecoration:"underline"}},s):null))},g=(e,t,a)=>{let r="";if(t){const t=a.replace(/[A-Z]/g,"").length-String(e).length;Array.from({length:t}).forEach((()=>r+="0"))}return r+String(e)};class N extends e.exports.Component{constructor(e){super(e);const t=localStorage.getItem("state"),a=JSON.parse(t);this.state={templateName:t?a.templateName:"",libName:t?a.libName:"",perPage:0,startNumber:t?a.startNumber:"100000",isStartZero:!1,countNumber:"1",splitNumbers:[],checkDigit:!1,univStartAlphabet:null,printing:!1}}componentDidMount(){if(""===location.hash)this.setTemplate("aone-28368",!1),this.setStartNumber(this.state.startNumber);else{const e=c.parse(location.hash);let t=e.template;t&&u[t]&&this.setTemplate(t,!1);let a=e.startNumber;a?this.setState({startNumber:a},(()=>this.setStartNumber(this.state.startNumber))):this.setStartNumber(this.state.startNumber)}window.addEventListener("afterprint",(e=>{this.setState({printing:!1})}))}setTemplate(e,t=!0){let a=u[e].labelCountX*u[e].labelCountY;this.setState({perPage:a,templateName:e},(()=>{this.renderBarCodes(),this.saveState()})),t&&(location.hash=c.stringify({template:e}))}setStartNumber(e){if(""===e)return;const t=!!e.match(/^[A-Z]*?0+[0-9]+/);let a=null;if(e.match(/^[A-Z]+[0-9]+C?$/)){let t=e.match(/^[A-Z]+/);t&&(a=t[0])}const r=!!e.match(/C$/);this.setState({startNumber:e,isStartZero:t,checkDigit:r,univStartAlphabet:a},(()=>{this.renderBarCodes(),this.saveState()}))}setCountNumber(e){this.setState({countNumber:e},this.renderBarCodes.bind(this))}setLibName(e){this.setState({libName:e},this.saveState.bind(this))}saveState(){const e={templateName:this.state.templateName,libName:this.state.libName,startNumber:this.state.startNumber};localStorage.setItem("state",JSON.stringify(e))}renderBarCodes(){const e=parseInt(this.state.startNumber.replace(/[A-Z]/g,"")),t=parseInt(this.state.countNumber)*this.state.perPage,a=[];let r=e;Array.from({length:t}).forEach((()=>{let e=g(r,this.state.isStartZero,this.state.startNumber);a.push(e),r+=1}));const l=((e,t)=>{const a=[];for(let r=0;r<e.length;r+=t){const l=e.slice(r,r+t);a.push(l)}return a})(a,this.state.perPage);return this.setState({splitNumbers:l}),!0}render(){return t.createElement(t.Fragment,null,t.createElement("header",null,t.createElement("h1",null,"カーリルToolBox: バーコード連番印刷")),t.createElement("div",{className:"container"},t.createElement(d,{templateName:this.state.templateName,onSelectTemplate:this.setTemplate.bind(this),startNumber:this.state.startNumber,countNumber:this.state.countNumber,changeStartNumber:this.setStartNumber.bind(this),changeCountNumber:this.setCountNumber.bind(this),libName:this.state.libName,setLibName:this.setLibName.bind(this),renderBarCodes:this.renderBarCodes.bind(this),printing:this.state.printing,print:()=>{this.setState({printing:!0},(()=>{setTimeout((()=>{print()}),300)}))}}),t.createElement("div",{className:"sheets"},this.state.splitNumbers.map(((e,a)=>{const r=u[this.state.templateName];return t.createElement(E,{key:a,index:a,numbers:e,template:r,startNumber:this.state.startNumber,perPage:this.state.perPage,libName:this.state.libName,univStartAlphabet:this.state.univStartAlphabet,checkDigit:this.state.checkDigit,isStartZero:this.state.isStartZero,printing:this.state.printing})})),this.state.splitNumbers.length>5?t.createElement("p",{className:"nopreview"},"6枚目以降はプレビューされません"):null),t.createElement("footer",null,t.createElement("span",{className:"poweredby"})),this.state.printing?t.createElement("div",{className:"printing"},"印刷準備中..."):null))}}const E=e=>{const{index:a,numbers:r,template:l,startNumber:n,perPage:s,libName:i,univStartAlphabet:m,checkDigit:o,isStartZero:p,printing:c}=e;if(!1===c&&a>=5)return null;const h=g(parseInt(n.replace(/[A-Z]/g,""))+s*a,p,n),u=g(parseInt(n.replace(/[A-Z]/g,""))-1+s*(a+1),p,n);return t.createElement("section",{className:"sheet",style:{paddingTop:l.marginTop,paddingLeft:l.marginLeft,display:"grid",gridTemplateColumns:`repeat(${l.labelCountX}, ${l.labelWidth})`,gridTemplateRows:`repeat(${l.labelCountY}, ${l.labelHeight})`,columnGap:l.gapX,rowGap:l.gapY}},t.createElement("p",{style:{position:"absolute",top:parseFloat(l.marginTop)-7>0?(parseFloat(l.marginTop)-7)/2+"mm":"0",right:"right"===l.headerPosition?parseInt(l.marginLeft)+parseInt(l.gapX)+"mm":"auto",left:"left"===l.headerPosition?parseInt(l.marginLeft)+parseInt(l.gapX)+"mm":"auto",fontSize:"3mm"}},h,"-",u," / ",null!==m?"Code39":"NW-7",o?" (M10W21)":""," / ",a+1,"枚目"),r.map((e=>{let a=null;return o&&(a=(e=>{const t=e.split("").reverse().map(((e,t)=>{const a=parseInt(e);return t%2==0?(2*a).toString().split("").reduce(((e,t)=>e+parseInt(t)),0):a})).reduce(((e,t)=>e+t),0);return t%10==0?0:10-t%10})(e.replace(/[A-Z]/g,""))),t.createElement(b,{number:e,checkDigit:a,univStartAlphabet:m,libName:i,template:l,key:e})})),t.createElement("img",{src:"./assets/calil.svg",alt:"カーリル",className:"logo",style:{position:"absolute",bottom:parseFloat(l.marginTop)-7>0?parseFloat(l.marginTop)-7+"mm":"0",left:parseInt(l.marginLeft)+parseInt(l.gapX)+"mm",fontSize:"3mm"}}))};h.render(t.createElement(t.StrictMode,null,t.createElement(N,null)),document.getElementById("root"));
